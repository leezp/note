
## weblogic CVE-2019-2725绕过


漏洞位于 Weblogic 内置的“ wls9_async_response.war ”组件与“ wls-wsat.war ”组件

绕过原理
2725的补丁过滤了object/new/method标签，void标签只允许用index，array的class只能用byte，并限制了长度，如上XML避开了过滤。并不会对byte相关属性进行屏蔽，这也就导致了可以使用byte流配合UnitOfWorkChangeSet加上JDK7U21原生的反序列化漏洞进行完美绕过。而Weblogic安装包中默认SDK为1.6版本，所以当被攻击机的JDK版本<=JDK7u21就存在原生反序列化漏洞。
利用JDK 7u21反序列化漏洞造成了远程代码执行。通过巧妙的利用了void、array和Class这三个元素成功的打造了利用链，再次完美的绕过了CVE-2019-2725补丁限制，本次漏洞的发现进一步证明了依靠黑名单机制是一种不可靠的防护措施。


影响
Oracle WebLogic Server10.3.6.0.0

Oracle WebLogic Server12.1.3.0.0

Oracle WebLogic Server12.2.1.1.0

Oracle WebLogic Server12.2.1.2.0

### 环境 

win7  jdk1.7.0_03



### 参考

[WebLogic wls9-async 反序列化漏洞](https://b1ue.cn/archives/127.html)


[ysoserial.jar](https://github.com/frohoff/ysoserial)

```java -jar ysoserial.jar Jdk7u21 "whoami"  > payload.txt```

```javac Payload.java```  //编译成.class文件

```java Payload```    //执行，生成payloadoutput.txt


http://ip:7001/console 
