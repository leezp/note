alert tcp any any -> any 445 (msg:"SMBGhost attampt";content:"|fe|SMB@"; flowbits:set,smb0796; flowbits:noalert;sid:3000083;classtype:cve-exploit;)
alert tcp any 445 -> any any (msg:"SMBGhost attampt";flow:established,to_client;  pcre:"/SMB@[\s\S]+?NEGOEXTS[\s\S]+?NEGOEXTS[\s\S]+?Token Signing Public Key0[\s\S]+?Token Signing Public Key/"; flowbits:isset,smb0796; classtype:cve-exploit; sid:3000084;)



检测现网的poc扫描，效果较好
alert tcp any 445 -> any any (msg:"SMBGhost scan";flow:established,to_client;  pcre:"/SMB@[\s\S]+?NEGOEXTS[\s\S]+?NEGOEXTS[\s\S]+?Token Signing Public Key0[\s\S]+?Token Signing Public Key/"; classtype:cve-exploit; sid:3000086;)

DDos 攻击载荷  (检测 DDos 蓝屏)

alert tcp any any -> any 445 (msg:"SMBGhost DDOS page 1";content:"|fe|SMB@"; fast_pattern; content:"NTLMSSP|00 01 00 00 00 32|"; flowbits:set,smbdos; flowbits:noalert; sid:3000129; classtype:cve-exploit;)
alert tcp any 445 -> any any (msg:"SMBGhost DDOS page 1";flow:established,to_client; content:"|fe|SMB@"; content:"|00|NTLMSSP|00|"; flowbits:isset,smbdos; classtype:cve-exploit; sid:3000130;)

检测 DDos 蓝屏
alert tcp any any -> any 445 (msg:"SMBGhost DDOS"; content:"|fc|SMB"; fast_pattern; content:"|31 fe|SMB@|00|"; distance:13; content:"|00|NTLMSSP|00|"; sid:3000131; classtype:cve-exploit;)

