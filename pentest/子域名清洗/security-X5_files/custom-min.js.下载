/*
Copyright 2013, KISSY v1.41
MIT Licensed
build time: Dec 4 22:15
*/
KISSY.add("event/custom/observer",["event/base"],function(g,c){function a(){a.superclass.constructor.apply(this,arguments)}var i=c("event/base");g.extend(a,i.Observer,{keys:["fn","context","groups"]});return a});KISSY.add("event/custom/object",["event/base"],function(g,c){function a(c){a.superclass.constructor.call(this);g.mix(this,c)}var i=c("event/base");g.extend(a,i.Object);return a});
KISSY.add("event/custom/observable",["event/base","./observer","./object"],function(g,c){function a(){a.superclass.constructor.apply(this,arguments);this.defaultFn=null;this.defaultTargetOnly=!1;this.bubbles=!0}var i=c("event/base"),j=c("./observer"),n=c("./object"),k=i.Utils;g.extend(a,i.Observable,{on:function(b){b=new j(b);g.Config.debug&&(b.fn||"lack event handler for "+this.type);-1===this.findObserver(b)&&this.observers.push(b)},fire:function(b){var b=b||{},f=this.bubbles,d=this.currentTarget,
e,k=this.type,m=this.defaultFn,l,h=b,a;b.type=k;h instanceof n||(h.target=d,h=new n(h));h.currentTarget=d;b=this.notify(h);!1!==a&&void 0!==b&&(a=b);if(f&&!h.isPropagationStopped()){e=(f=d.getTargets())&&f.length||0;for(l=0;l<e&&!h.isPropagationStopped();l++)b=f[l].fire(k,h),!1!==a&&void 0!==b&&(a=b)}if(m&&!h.isDefaultPrevented()&&(k=h.target,b=k.getCustomEventObservable(h.type),!this.defaultTargetOnly&&!b.defaultTargetOnly||d===k))a=m.call(d,h);return a},notify:function(b){var f=[].concat(this.observers),
d,e,k=f.length,a;for(a=0;a<k&&!b.isImmediatePropagationStopped();a++)d=f[a].notify(b,this),!1!==e&&void 0!==d&&(e=d);return e},detach:function(b){var a,d=b.fn,e=b.context,g=this.currentTarget,m=this.observers,b=b.groups;if(m.length){b&&(a=k.getGroupsRe(b));var l,h,c,i,j=m.length;if(d||a){e=e||g;l=b=0;for(h=[];b<j;++b)if(c=m[b],i=c.context||g,e!==i||d&&d!==c.fn||a&&!c.groups.match(a))h[l++]=c;this.observers=h}else this.reset()}}});return a});
KISSY.add("event/custom/target",["event/base","./observable"],function(g,c){var a=c("event/base"),i=c("./observable"),j=a.Utils,n=j.splitAndRun;return{isTarget:1,getCustomEventObservable:function(a,b){var f,d=this.getCustomEvents();f=d&&d[a];!f&&b&&(f=d[a]=new i({currentTarget:this,type:a}));return f},fire:function(a,b){var f=this,d,e=f.getTargets(),c=e&&e.length,b=b||{};n(a,function(a){var e;j.fillGroupsForEvent(a,b);a=b.type;if((e=f.getCustomEventObservable(a))||c){if(e){if(!e.hasObserver()&&!e.defaultFn&&
(e.bubbles&&!c||!e.bubbles))return}else e=new i({currentTarget:f,type:a});a=e.fire(b);!1!==d&&void 0!==a&&(d=a)}});return d},publish:function(a,b){var c,d=this;n(a,function(a){c=d.getCustomEventObservable(a,!0);g.mix(c,b)});return d},addTarget:function(a){var b=this.getTargets();g.inArray(a,b)||b.push(a);return this},removeTarget:function(a){var b=this.getTargets(),a=g.indexOf(a,b);-1!==a&&b.splice(a,1);return this},getTargets:function(){return this["__~ks_bubble_targets"]||(this["__~ks_bubble_targets"]=
[])},getCustomEvents:function(){return this["__~ks_custom_events"]||(this["__~ks_custom_events"]={})},on:function(a,b,c){var d=this;j.batchForType(function(a,b,c){b=j.normalizeParam(a,b,c);a=b.type;if(a=d.getCustomEventObservable(a,!0))a.on(b)},0,a,b,c);return d},detach:function(a,b,c){var d=this;j.batchForType(function(a,b,c){var f=j.normalizeParam(a,b,c);(a=f.type)?(a=d.getCustomEventObservable(a,!0))&&a.detach(f):(a=d.getCustomEvents(),g.each(a,function(a){a.detach(f)}))},0,a,b,c);return d}}});
KISSY.add("event/custom",["./custom/target"],function(g,c){var a=c("./custom/target");return{Target:a,global:g.mix({},a)}});
